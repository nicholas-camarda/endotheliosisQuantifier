# Technical Summary

## Pipeline Overview
- Data prep/cache: parse annotations, generate masks, split train/val/test, cache arrays.
- Segmentation: U-Net fine-tuning to detect glomeruli.
- ROI extraction: contour-based ROI extraction from masked images; save to disk.
- Feature extraction: ResNet50 (imagenet) features per ROI.
- Quantification: Random Forest regression to estimate endotheliosis score with CI output.

## CLI Interface
- Central `eq` command with subcommands for each pipeline step
- `eq data-load` - Load and preprocess data with configurable paths
- `eq train-segmenter` - Train segmentation models with hyperparameter control  
- `eq extract-features` - Extract features from images using trained models
- `eq quantify` - Run endotheliosis quantification pipeline
- `eq pipeline` - Execute complete end-to-end pipeline
- All commands support `--help` for usage information

## Package Structure
- `src/eq/` - Main package with modular organization
- `src/eq/__main__.py` - CLI entry point with argument parsing
- `src/eq/features/` - Data loading and preprocessing
- `src/eq/segmentation/` - Model training and inference
- `src/eq/models/` - Feature extraction and model utilities
- `src/eq/pipeline/` - Main quantification logic
- `src/eq/utils/` - Common utilities and helpers

## Notable Paths (to be centralized)
- Data root: `data/preeclampsia_data` (train/test/cache subdirs)
- Outputs: `output/` (models, predictions)

## Next Steps (engineering)
- Resolve segmentation_models import issues for full CLI functionality
- Add sample data and smoke tests runnable on M1 and in WSL2
- Package release prep (README, examples, versioning)
- Batch inference CLI for researcher datasets
